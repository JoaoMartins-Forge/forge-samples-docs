"use strict";(self.webpackChunkforge_samples_docs=self.webpackChunkforge_samples_docs||[]).push([[597],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var o=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,i=function(e,n){if(null==e)return{};var t,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=o.createContext({}),p=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},c=function(e){var n=p(e.components);return o.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),m=i,k=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return t?o.createElement(k,a(a({ref:n},c),{},{components:t})):o.createElement(k,a({ref:n},c))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,a=new Array(r);a[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,a[1]=l;for(var p=2;p<r;p++)a[p]=t[p];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},7787:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var o=t(7462),i=t(3366),r=(t(7294),t(3905)),a=["components"],l={sidebar_position:4},s="Prohl\xed\u017ee\u010d & u\u017eivatelsk\xe9 rozhran\xed",p={unversionedId:"tutorials/simple-viewer/nodejs/viewer",id:"tutorials/simple-viewer/nodejs/viewer",isDocsHomePage:!1,title:"Prohl\xed\u017ee\u010d & u\u017eivatelsk\xe9 rozhran\xed",description:"Nyn\xed m\u016f\u017eeme p\u0159ej\xedt ke klientsk\xe9 \u010d\xe1sti na\u0161\xed aplikace.",source:"@site/i18n/cz/docusaurus-plugin-content-docs/current/tutorials/simple-viewer/nodejs/viewer.md",sourceDirName:"tutorials/simple-viewer/nodejs",slug:"/tutorials/simple-viewer/nodejs/viewer",permalink:"/forge-samples-docs/cz/docs/tutorials/simple-viewer/nodejs/viewer",editUrl:"https://github.com/petrbroz/forge-samples-docs/edit/main/website/docs/tutorials/simple-viewer/nodejs/viewer.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Spr\xe1va soubor\u016f",permalink:"/forge-samples-docs/cz/docs/tutorials/simple-viewer/nodejs/data"},next:{title:"Basic Server",permalink:"/forge-samples-docs/cz/docs/tutorials/simple-viewer/dotnet/server"}},c=[{value:"Funkce prohl\xed\u017ee\u010de",id:"funkce-prohl\xed\u017ee\u010de",children:[]},{value:"Funkce aplikace",id:"funkce-aplikace",children:[]},{value:"U\u017eivatelsk\xe9 rozhran\xed",id:"u\u017eivatelsk\xe9-rozhran\xed",children:[]},{value:"Zkou\u0161ka",id:"zkou\u0161ka",children:[]}],u={toc:c};function d(e){var n=e.components,l=(0,i.Z)(e,a);return(0,r.kt)("wrapper",(0,o.Z)({},u,l,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"prohl\xed\u017ee\u010d--u\u017eivatelsk\xe9-rozhran\xed"},"Prohl\xed\u017ee\u010d & u\u017eivatelsk\xe9 rozhran\xed"),(0,r.kt)("p",null,"Nyn\xed m\u016f\u017eeme p\u0159ej\xedt ke klientsk\xe9 \u010d\xe1sti na\u0161\xed aplikace."),(0,r.kt)("h2",{id:"funkce-prohl\xed\u017ee\u010de"},"Funkce prohl\xed\u017ee\u010de"),(0,r.kt)("p",null,"Za\u010dn\u011bme implementac\xed funkc\xed prohl\xed\u017ee\u010de Forge Viewer. Vytvo\u0159te soubor ",(0,r.kt)("inlineCode",{parentName:"p"},"viewer.js")," v adres\xe1\u0159i ",(0,r.kt)("inlineCode",{parentName:"p"},"public"),",\na vlo\u017ete do n\u011bj n\xe1sleduj\xedc\xed k\xf3d:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="public/viewer.js"',title:'"public/viewer.js"'},"export async function initViewer(container) {\n    async function getAccessToken(callback) {\n        const resp = await fetch('/api/auth/token');\n        if (resp.ok) {\n            const { access_token, expires_in } = await resp.json();\n            callback(access_token, expires_in);\n        } else {\n            alert('Could not obtain access token. See the console for more details.');\n            console.error(await resp.text());\n        }\n    }\n    return new Promise(function (resolve, reject) {\n        Autodesk.Viewing.Initializer({ getAccessToken }, async function () {\n            const viewer = new Autodesk.Viewing.GuiViewer3D(container);\n            viewer.start();\n            viewer.setTheme('light-theme');\n            resolve(viewer);\n        });\n    });\n}\n\nexport function loadModel(viewer, urn) {\n    function onDocumentLoadSuccess(doc) {\n        viewer.loadDocumentNode(doc, doc.getRoot().getDefaultGeometry());\n    }\n    function onDocumentLoadFailure(code, message) {\n        alert('Could not load model. See the console for more details.');\n        console.error(message);\n    }\n    Autodesk.Viewing.Document.load('urn:' + urn, onDocumentLoadSuccess, onDocumentLoadFailure);\n}\n")),(0,r.kt)("p",null,"Tento skript je ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules"},"ES6 modul"),"\nkter\xfd poskytuje dv\u011b funkce, ",(0,r.kt)("inlineCode",{parentName:"p"},"initViewer"),", kter\xe1 vytvo\u0159\xed novou instanci prohl\xed\u017ee\u010de, v konkr\xe9tn\xedm elementu DOM,\na ",(0,r.kt)("inlineCode",{parentName:"p"},"loadModel"),", kter\xe1 do tohoto prohl\xed\u017ee\u010de na\u010dte konkr\xe9tn\xed model."),(0,r.kt)("h2",{id:"funkce-aplikace"},"Funkce aplikace"),(0,r.kt)("p",null,"D\xe1le m\u016f\u017eeme definovat funkcionalitu samotn\xe9 aplikace. Pot\u0159ebujeme naplnit u\u017eivatelsk\xe9\nrozhran\xed modely, kter\xe9 jsou p\u0159iraven\xe9 k prohl\xed\u017een\xed, a tak\xe9 p\u0159ipravit prvky UI\npro nahr\xe1v\xe1n\xed nov\xfdch model\u016f. Vytvo\u0159e soubor ",(0,r.kt)("inlineCode",{parentName:"p"},"main.js")," v adres\xe1\u0159i ",(0,r.kt)("inlineCode",{parentName:"p"},"public")," a vlo\u017ete\ndo n\u011bj n\xe1sleduj\xedc\xed k\xf3d:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="public/main.js"',title:'"public/main.js"'},"import { initViewer, loadModel } from './viewer.js';\n\ninitViewer(document.getElementById('preview')).then(viewer => {\n    const urn = window.location.hash ? window.location.hash.substr(1) : null;\n    setupModelSelection(viewer, urn);\n    setupModelUpload(viewer);\n});\n\nasync function setupModelSelection(viewer, selectedUrn) {\n    const models = document.getElementById('models');\n    models.innerHTML = '';\n    const resp = await fetch('/api/models');\n    if (resp.ok) {\n        for (const model of await resp.json()) {\n            const option = document.createElement('option');\n            option.innerText = model.name;\n            option.setAttribute('value', model.urn);\n            if (model.urn === selectedUrn) {\n                option.setAttribute('selected', 'true');\n            }\n            models.appendChild(option);\n        }\n    } else {\n        alert('Could not list models. See the console for more details.');\n        console.error(await resp.text());\n    }\n    models.onchange = () => {\n        window.location.hash = models.value;\n        loadModel(viewer, models.value);\n    }\n    if (!viewer.model && models.value) {\n        models.onchange();\n    }\n}\n\nasync function setupModelUpload(viewer) {\n    const button = document.getElementById('upload');\n    const input = document.getElementById('input');\n    button.addEventListener('click', async function () {\n        input.click();\n    });\n    input.addEventListener('change', async function () {\n        if (input.files.length !== 1) {\n            return;\n        }\n        const file = input.files[0];\n        let data = new FormData();\n        data.append('model-file', file);\n        // When uploading a zip file, ask for the main design file in the archive\n        if (file.name.endsWith('.zip')) {\n            const entrypoint = window.prompt('Please enter the filename of the main design inside the archive.');\n            data.append('model-zip-entrypoint', entrypoint);\n        }\n        const resp = await fetch('/api/models', { method: 'POST', body: data });\n        if (resp.ok) {\n            input.value = '';\n            setupModelSelection(viewer);\n        } else {\n            alert('Could not upload model. See the console for more details.');\n            console.error(await resp.text());\n        }\n    });\n}\n")),(0,r.kt)("p",null,"Tento skript inicializuje prohl\xed\u017ee\u010d Forge Viewer, napln\xed rozbalovac\xed nab\xeddku s modely k prohl\xed\u017een\xed,\na p\u0159iprav\xed u\u017eivatelsk\xe9 rozhran\xed pro nahr\xe1v\xe1n\xed nov\xfdch model\u016f. V p\u0159\xedpad\u011b, \u017ee je p\u0159\xedpona nahr\xe1van\xe9ho\nsouboru .zip, tento JavaScript k\xf3d se tak\xe9 dot\xe1\u017ee na n\xe1zev souboru uvnit\u0159 tohoto archivu, kter\xfd\nby m\u011bl b\xfdt zkonvertov\xe1n."),(0,r.kt)("h2",{id:"u\u017eivatelsk\xe9-rozhran\xed"},"U\u017eivatelsk\xe9 rozhran\xed"),(0,r.kt)("p",null,"Nyn\xed u\u017e m\u016f\u017eeme za\u010d\xedt definovat u\u017eivatelsk\xe9 rozhran\xed na\u0161\xed webov\xe9 aplikace."),(0,r.kt)("p",null,"Vytvo\u0159te soubor ",(0,r.kt)("inlineCode",{parentName:"p"},"main.css")," v adres\xe1\u0159i ",(0,r.kt)("inlineCode",{parentName:"p"},"public")," a vlo\u017ete do n\u011bj n\xe1sleduj\xedc\xed k\xf3d:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-css",metastring:'title="public/main.css"',title:'"public/main.css"'},"body, html {\n    margin: 0;\n    padding: 0;\n    height: 100vh;\n}\n\n#header, #preview {\n    position: absolute;\n    width: 100%;\n}\n\n#header {\n    height: 3em;\n    display: flex;\n    flex-flow: row nowrap;\n    justify-content: space-between;\n    align-items: center;\n}\n\n#preview {\n    top: 3em;\n    bottom: 0;\n}\n\n#header > * {\n    height: 2em;\n    margin: 0 0.5em;\n    font-family: ArtifaktElement; /* Will be added by Forge Viewer */\n    font-size: 1em;\n}\n\n#header .title {\n    flex: 1 0 auto;\n    height: auto;\n}\n\n#models {\n    flex: 0 1 auto;\n    min-width: 2em;\n}\n")),(0,r.kt)("p",null,"D\xe1le vytvo\u0159te soubor ",(0,r.kt)("inlineCode",{parentName:"p"},"index.html")," v adres\xe1\u0159i ",(0,r.kt)("inlineCode",{parentName:"p"},"public")," s n\xe1sleduj\xedc\xedm obsahem:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="public/index.html"',title:'"public/index.html"'},'<!DOCTYPE html>\n<html lang="en">\n\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <link rel="stylesheet" href="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/style.css">\n    <link rel="stylesheet" href="/main.css">\n    <title>Autodesk Forge: Simple Viewer</title>\n</head>\n\n<body>\n    <div id="header">\n        <img class="logo" src="/logo.png" alt="Autodesk Forge">\n        <span class="title">Simple Viewer</span>\n        <select name="models" id="models"></select>\n        <button id="upload" title="Upload New Model">Upload</button>\n        <input style="display: none" type="file" id="input">\n    </div>\n    <div id="preview"></div>\n    <script src="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/viewer3D.js"><\/script>\n    <script src="/main.js" type="module"><\/script>\n</body>\n\n</html>\n')),(0,r.kt)("p",null,"HTML v podstat\u011b pou\u017e\xedv\xe1 ",(0,r.kt)("inlineCode",{parentName:"p"},"<select>")," element pro v\xfd\u010det model\u016f, kter\xe9 jsou k dispozici k prohl\xed\u017een\xed,\na ",(0,r.kt)("inlineCode",{parentName:"p"},'<input type="file">')," element s ",(0,r.kt)("inlineCode",{parentName:"p"},"<button>")," tla\u010d\xedtkem pro nahr\xe1v\xe1n\xed nov\xfdch model\u016f."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Jeliko\u017e je soubor ",(0,r.kt)("inlineCode",{parentName:"p"},"public/main.js")," takt\xe9\u017e ES6 modulem, mus\xedme v jeho skriptu pou\u017e\xedt ",(0,r.kt)("inlineCode",{parentName:"p"},'type="module"'),".")),(0,r.kt)("p",null,"Na\u0161e aplikace bude tak\xe9 hledat soubory ",(0,r.kt)("inlineCode",{parentName:"p"},"favicon.ico")," a ",(0,r.kt)("inlineCode",{parentName:"p"},"logo.png")," v adres\xe1\u0159i ",(0,r.kt)("inlineCode",{parentName:"p"},"public")," pro pou\u017eit\xed\njako ikonu a logo webov\xe9 str\xe1nky. Pokud nem\xe1te vlastn\xed obr\xe1zky, m\u016f\u017eete pou\u017e\xedt tyto:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/petrbroz/forge-simple-viewer-nodejs/blob/develop/public/favicon.ico"},"https://github.com/petrbroz/forge-simple-viewer-nodejs/blob/develop/public/favicon.ico")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/petrbroz/forge-simple-viewer-nodejs/blob/develop/public/logo.png"},"https://github.com/petrbroz/forge-simple-viewer-nodejs/blob/develop/public/logo.png"))),(0,r.kt)("h2",{id:"zkou\u0161ka"},"Zkou\u0161ka"),(0,r.kt)("p",null,"A to je v\u0161e! Va\u0161e aplikace je nyn\xed p\u0159ipravena k akci. Spus\u0165te ji z p\u0159\xedkazov\xe9 \u0159\xe1dky jako obvykle:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"export FORGE_CLIENT_ID=your-own-forge-client-id\nexport FORGE_CLIENT_SECRET=your-own-forge-client-secret\nexport FORGE_BUCKET=your-custom-bucket-name\nnpm start\n")),(0,r.kt)("p",null,"A pot\xe9 otev\u0159ete http://localhost:3000 ve Va\u0161em prohl\xed\u017ee\u010di. M\u011bli byste vid\u011bt jednoduch\xe9 u\u017eivatelsk\xe9\nrozhran\xed s rozbalovac\xed nab\xeddkou v prav\xe9m horn\xedm rohu, kter\xe1 bude zanedlouho napln\u011bna seznamem model\u016f.\nA jakmile z t\xe9to nab\xeddky jeden model vyberete, m\u011bl by se hned na\u010d\xedst v prohl\xed\u017ee\u010di, kter\xfd zab\xedr\xe1\nzbytek plochy webov\xe9 str\xe1nky."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Final App",src:t(4291).Z})))}d.isMDXComponent=!0},4291:function(e,n,t){n.Z=t.p+"assets/images/final-app-2be100724fa936e67f930f8d8b33be53.png"}}]);